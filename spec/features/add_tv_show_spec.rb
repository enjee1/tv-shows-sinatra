require "spec_helper"

feature "user adds a new TV show" do
  let (:synopsis) { "Voluptas omnis aliquam dolores nisi rem vero dignissimos quia. Harum error fugit qui. Explicabo repellendus voluptas ad dolore omnis vel. Ipsam fugit sit voluptas qui. Et et exercitationem assumenda alias. Enim et nostrum aliquam dolores quaerat. Hic labore est animi recusandae consequatur id. Sit accusantium optio et exercitationem. Odio odit quia praesentium officiis rem est.
    Excepturi dolores id illum. Voluptas ut ea atque ea repellendus ut ut. Consequuntur omnis saepe libero nam et quia. Aut sapiente et saepe nesciunt ducimus minima recusandae. Rerum quia et incidunt maiores. Cupiditate at possimus sint quam a molestias. Fuga asperiores placeat sequi qui deleniti quidem quae ipsum. Consequatur omnis enim accusantium beatae. Aut voluptatem mollitia magnam quia quia ut aspernatur. Quibusdam magnam sed officia quibusdam itaque. Perferendis quia non in eum impedit veritatis. Nostrum accusamus aut totam natus explicabo. Eaque aut est quisquam non cum id. Eos maxime amet et perferendis. Cupiditate quaerat est rem laborum laboriosam. Voluptas omnis aliquam dolores nisi rem vero dignissimos quia. Harum error fugit qui. Explicabo repellendus voluptas ad dolore omnis vel. Ipsam fugit sit voluptas qui. Et et exercitationem assumenda alias. Enim et nostrum aliquam dolores quaerat. Hic labore est animi recusandae consequatur id. Sit accusantium optio et exercitationem. Odio odit quia praesentium officiis rem est.
      Excepturi dolores id illum. Voluptas ut ea atque ea repellendus ut ut. Consequuntur omnis saepe libero nam et quia. Aut sapiente et saepe nesciunt ducimus minima recusandae. Rerum quia et incidunt maiores. Cupiditate at possimus sint quam a molestias. Fuga asperiores placeat sequi qui deleniti quidem quae ipsum. Consequatur omnis enim accusantium beatae. Aut voluptatem mollitia magnam quia quia ut aspernatur. Quibusdam magnam sed officia quibusdam itaque. Perferendis quia non in eum impedit veritatis. Nostrum accusamus aut totam natus explicabo. Eaque aut est quisquam non cum id. Eos maxime amet et perferendis. Cupiditate quaerat est rem laborum laboriosam. Voluptas omnis aliquam dolores nisi rem vero dignissimos quia. Harum error fugit qui. Explicabo repellendus voluptas ad dolore omnis vel. Ipsam fugit sit voluptas qui. Et et exercitationem assumenda alias. Enim et nostrum aliquam dolores quaerat. Hic labore est animi recusandae consequatur id. Sit accusantium optio et exercitationem. Odio odit quia praesentium officiis rem est.
        Excepturi dolores id illum. Voluptas ut ea atque ea repellendus ut ut. Consequuntur omnis saepe libero nam et quia. Aut sapiente et saepe nesciunt ducimus minima recusandae. Rerum quia et incidunt maiores. Cupiditate at possimus sint quam a molestias. Fuga asperiores placeat sequi qui deleniti quidem quae ipsum. Consequatur omnis enim accusantium beatae. Aut voluptatem mollitia magnam quia quia ut aspernatur. Quibusdam magnam sed officia quibusdam itaque. Perferendis quia non in eum impedit veritatis. Nostrum accusamus aut totam natus explicabo. Eaque aut est quisquam non cum id. Eos maxime amet et perferendis. Cupiditate quaerat est rem laborum laboriosam. Voluptas omnis aliquam dolores nisi rem vero dignissimos quia. Harum error fugit qui. Explicabo repellendus voluptas ad dolore omnis vel. Ipsam fugit sit voluptas qui. Et et exercitationem assumenda alias. Enim et nostrum aliquam dolores quaerat. Hic labore est animi recusandae consequatur id. Sit accusantium optio et exercitationem. Odio odit quia praesentium officiis rem est.
          Excepturi dolores id illum. Voluptas ut ea atque ea repellendus ut ut. Consequuntur omnis saepe libero nam et quia. Aut sapiente et saepe nesciunt ducimus minima recusandae. Rerum quia et incidunt maiores. Cupiditate at possimus sint quam a molestias. Fuga asperiores placeat sequi qui deleniti quidem quae ipsum. Consequatur omnis enim accusantium beatae. Aut voluptatem mollitia magnam quia quia ut aspernatur. Quibusdam magnam sed officia quibusdam itaque. Perferendis quia non in eum impedit veritatis. Nostrum accusamus aut totam natus explicabo. Eaque aut est quisquam non cum id. Eos maxime amet et perferendis. Cupiditate quaerat est rem laborum laboriosam. Voluptas omnis aliquam dolores nisi rem vero dignissimos quia. Harum error fugit qui. Explicabo repellendus voluptas ad dolore omnis vel. Ipsam fugit sit voluptas qui. Et et exercitationem assumenda alias. Enim et nostrum aliquam dolores quaerat. Hic labore est animi recusandae consequatur id. Sit accusantium optio et exercitationem. Odio odit quia praesentium officiis rem est.
            Excepturi dolores id illum. Voluptas ut ea atque ea repellendus ut ut. Consequuntur omnis saepe libero nam et quia. Aut sapiente et saepe nesciunt ducimus minima recusandae. Rerum quia et incidunt maiores. Cupiditate at possimus sint quam a molestias. Fuga asperiores placeat sequi qui deleniti quidem quae ipsum. Consequatur omnis enim accusantium beatae. Aut voluptatem mollitia magnam quia quia ut aspernatur. Quibusdam magnam sed officia quibusdam itaque. Perferendis quia non in eum impedit veritatis. Nostrum accusamus aut totam natus explicabo. Eaque aut est quisquam non cum id. Eos maxime amet et perferendis. Cupiditate quaerat est rem laborum laboriosam. Voluptas omnis aliquam dolores nisi rem vero dignissimos quia. Harum error fugit qui. Explicabo repellendus voluptas ad dolore omnis vel. Ipsam fugit sit voluptas qui. Et et exercitationem assumenda alias. Enim et nostrum aliquam dolores quaerat. Hic labore est animi recusandae consequatur id. Sit accusantium optio et exercitationem. Odio odit quia praesentium officiis rem est.
              Excepturi dolores id illum. Voluptas ut ea atque ea repellendus ut ut. Consequuntur omnis saepe libero nam et quia. Aut sapiente et saepe nesciunt ducimus minima recusandae. Rerum quia et incidunt maiores. Cupiditate at possimus sint quam a molestias. Fuga asperiores placeat sequi qui deleniti quidem quae ipsum. Consequatur omnis enim accusantium beatae. Aut voluptatem mollitia magnam quia quia ut aspernatur. Quibusdam magnam sed officia quibusdam itaque. Perferendis quia non in eum impedit veritatis. Nostrum accusamus aut totam natus explicabo. Eaque aut est quisquam non cum id. Eos maxime amet et perferendis. Cupiditate quaerat est rem laborum laboriosam."}
  # As a TV fanatic
  # I want to add one of my favorite shows
  # So that I can encourage others to binge watch it
  #
  # Acceptance Criteria:
  # * I must provide the title, network, and starting year.
  # * I can optionally provide the final year, genre, and synopsis.
  # * The synopsis can be no longer than 5000 characters.
  # * The starting year and ending year (if provided) must be
  #   greater than 1900.
  # * The genre must be one of the following: Action, Mystery,
  #   Drama, Comedy, Fantasy
  # * If any of the above validations fail, the form should be
  #   re-displayed with the failing validation message.

  scenario "successfully add a new show" do
    visit "/television_shows/new"
    fill_in "television_show[title]", with: "Friends"
    fill_in "television_show[network]", with: "NBC"
    fill_in "television_show[starting_year]", with: 1994
    fill_in "television_show[ending_year]", with: 2004
    select value = "Comedy", from: "television_show[genre]"
    click_button("Add TV Show")
    expect(page).to have_content("Friends (NBC)")

    visit "/television_shows/new"
    fill_in "television_show[title]", with: "M*A*S*H"
    fill_in "television_show[network]", with: "CBS"
    fill_in "television_show[starting_year]", with: 1972
    click_button("Add TV Show")
    expect(page).to have_content("M*A*S*H (CBS)")
  end

  scenario "fail to add a show with invalid information" do
    visit "/television_shows/new"
    fill_in "television_show[title]", with: "Friends"
    fill_in "television_show[network]", with: "NBC"
    click_button("Add TV Show")
    expect(page).should have_no_content("TV Shows")
    expect(page).to have_content("Add Show")
    expect(page).to have_content("Starting year can't be blank")


    visit "/television_shows/new"
    fill_in "television_show[title]", with: "Community"
    fill_in "television_show[network]", with: "NBC"
    fill_in "television_show[starting_year]", with: 2009
    fill_in "television_show[synopsis]", with: synopsis
    select value = "Comedy", from: "television_show[genre]"
    click_button("Add TV Show")
    expect(page).should have_no_content("TV Shows")
    expect(page).to have_content("Add Show")
    expect(page).to have_content("Synopsis is too long (maximum is 5000 characters)")

    visit "/television_shows/new"
    fill_in "television_show[title]", with: "Less-Than-Civil War"
    fill_in "television_show[network]", with: "AMC"
    fill_in "television_show[starting_year]", with: 1860
    fill_in "Ending Year", with: 1865
    click_button("Add TV Show")
    expect(page).should have_no_content("TV Shows")
    expect(page).to have_content("Add Show")
    expect(page).to have_content("Starting year must be greater than 1900")
    expect(page).to have_content("Ending year must be greater than 1900")

    visit "/television_shows/new"
    spaceship_earth = TelevisionShow.new({
      title: "Spaceship Earth", network: "Fox", starting_year: 2006,
      genre: "Documentary"
    })

    expect(page.has_select?("television_show[genre]", options: ["Action", "Mystery", "Drama", "Comedy", "Fantasy"])).to eq(true)
    expect(page.has_select?("television_show[genre]", with_options: ["spaceship_earth.genre"])).to eq(false)

  end
end
